(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4900:function(e,t,r){Promise.resolve().then(r.bind(r,8787))},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var n=r(231),s=r.n(n)},8787:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _}});for(var n,s=r(7437),a=r(6463),o=r(7138),l=r(2265),c=r(4867),i=r(7054),u=r(9354),d={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},x=new Uint8Array(16),h=[],m=0;m<256;++m)h.push((m+256).toString(16).slice(1));var f=function(e,t,r){if(d.randomUUID&&!t&&!e)return d.randomUUID();var s=(e=e||{}).random||(e.rng||function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(x)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=s[a];return t}return function(e,t=0){return(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase()}(s)},p=r(2776),g=r(8500),j=r(4896),y=r(6648),b=r(2686),v=r(668),N=r(3847);function w(e){let{link:t,title:r,previewText:n,startEmoji:a,playCount:l,likeCount:i,userHandle:d}=e;return(0,s.jsx)(o.default,{href:t,className:"h-full transition-transform hover:scale-105",children:(0,s.jsxs)("div",{className:"p-4 border rounded-xl shadow-md h-full relative bg-blue-100",children:[(0,s.jsxs)("div",{className:"flex flex-col h-full justify-center items-center gap-2 pb-2",children:[(0,s.jsx)("h3",{className:"text-xl text-center",children:r}),(0,s.jsx)("p",{className:"text-center text-sm",children:n}),(0,s.jsx)("p",{className:"text-4xl text-center",children:a})]}),(0,s.jsx)("div",{className:"absolute text-sm bottom-0 left-0 flex flex-row gap-x-1 text-gray-500 items-center bg-gray-100 px-1 rounded-tr-lg",children:(0,s.jsx)(o.default,{href:"/user/".concat(d),children:(0,s.jsxs)("p",{className:"max-w-[100px] truncate",children:["@",d]})})}),(0,s.jsxs)("div",{className:"absolute z-10 text-sm bottom-0 right-0 flex flex-row gap-x-1 text-gray-500 items-center bg-gray-100 px-1 rounded-tl-lg",children:[(0,s.jsx)(c.rgF,{}),(0,s.jsx)("p",{children:i}),(0,s.jsx)(c.o1U,{}),(0,s.jsx)("p",{children:(0,u.uf)(l)})]})]})})}function E(e){let{customGames:t}=e;return(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("div",{className:"mb-2 bg-blue-700 rounded-xl p-2",children:(0,s.jsx)("h2",{className:"text-lg w-full text-center text-white",children:"Custom games from the community"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,s.jsx)(o.default,{href:"/custom",className:"h-full transition-transform hover:scale-105",children:(0,s.jsx)("div",{className:"p-4 border rounded-xl shadow-md h-full relative bg-green-100",children:(0,s.jsxs)("div",{className:"flex flex-col h-full justify-center items-center gap-2 pb-2",children:[(0,s.jsx)("h3",{className:"text-xl text-center",children:"Create your own"}),(0,s.jsx)("p",{className:"text-4xl",children:" ➕ "})]})})}),t.map(e=>{var t,r,n,a,o,l,c,i;return(0,s.jsx)(w,{link:"/user/".concat(e.user_handle,"/custom"),title:null!==(o=null===(t=e.attribute_data)||void 0===t?void 0:t.title)&&void 0!==o?o:"Untitled",previewText:"What ".concat(null!==(l=null===(r=e.attribute_data)||void 0===r?void 0:r.judgingCriteria)&&void 0!==l?l:"beats"," ").concat(null!==(c=null===(n=e.attribute_data)||void 0===n?void 0:n.startWord)&&void 0!==c?c:"rock","?"),startEmoji:null!==(i=null===(a=e.attribute_data)||void 0===a?void 0:a.startEmoji)&&void 0!==i?i:"\uD83E\uDEA8",playCount:e.execution_count,likeCount:e.denormalized_vote_count,userHandle:e.user_handle},e.id)})]})]})}var D=r(1149);function _(){var e;let[t,r]=(0,l.useState)(0),[n,d]=(0,l.useState)(!1),[x,h]=(0,l.useState)("paper"),[m,w]=(0,l.useState)(!1),_=Array.from({length:1},(e,t)=>({emoji:"\uD83E\uDEA8",text:"rock".concat(0===t?"":t+1)})),[S,C]=(0,l.useState)(()=>_),[k,T]=(0,l.useState)(!1),[O,R]=(0,l.useState)(0),[F,L]=(0,l.useState)("paper always covers rock. duh!"),[A,I]=(0,l.useState)([]),[G,U]=(0,l.useState)("GUESS"),[J,P]=(0,l.useState)(()=>f()),q=(0,a.useRouter)(),{user:V,profile:z,signOut:B,isLoadingInitial:H}=(0,j.m)();(0,i.Ol)(()=>{w(!0),W()});let W=async()=>{let e=await (0,D.Pn)();e&&I(e)};(0,i.JE)(()=>{z&&(!z.nux_step||z.nux_step<b.XQ?q.push("/join"):(0,N._)())},!H);let X=async()=>{if(n||!x)return;if(S.find(e=>e.text.replace(/\s+/g," ").trim().toLowerCase()===x.replace(/\s+/g," ").trim().toLowerCase())){alert("no repeats! try something else");return}if(!x.trim()){alert("type something");return}if(/\d/.test(x)){alert("I'm bad at numbers");return}if(/"/.test(x)){alert("pls no quotes lol");return}if(new RegExp(u.Vg).test(x)){alert("emoji?? \uD83E\uDEE0");return}if(x.length>280){alert("280 chars max");return}if(new RegExp(u.Ym).test(x)){alert("no funny business");return}d(!0),T(!1),R(0);let e=S[S.length-1].text,t=await fetch("/api/vs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prev:e,guess:x,gid:J})}).finally(()=>d(!1));if(504===t.status){alert("sorry, request took too long! try again in a few seconds"),(0,g.JL)(u.f_);return}let{data:s,error:a}=await t.json().finally(()=>d(!1));if(a||!s){console.error("submission failed",a),a===u.BP&&alert("sorry, try again in a few seconds"),a===u.$q&&alert("rate limit exceeded! slow down or dm us on discord/twitter"),a===u.qw&&alert("\uD83E\uDEE3"),a===u.nV&&alert("sorry, try again in a few seconds"),a===u.SH&&alert("weird guess, try a different one?");return}if((0,g.JL)(u.KI,{guess:x,prev:e}),L(s.reason),C(e=>[...e,{emoji:s.guess_emoji||"\uD83E\uDD37‍♂️",text:x}]),s.cached&&s.cache_count&&R(s.cache_count),s.guess_wins){if(r(e=>e+1),U("CORRECT"),!1===s.cached&&(T(!0),!H&&!z)){var o;let e=JSON.parse(null!==(o=localStorage.getItem("trophies"))&&void 0!==o?o:"[]");e.push(JSON.stringify({guess:{text:x,emoji:s.guess_emoji},prev:{text:S[S.length-1].text,emoji:S[S.length-1].emoji}})),localStorage.setItem("trophies",JSON.stringify(e))}}else U("LOSS")},$=async e=>{let{score:t,text:r,initials:n}=e;d(!0),R(0);let s=await fetch("/api/scores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({score:t,text:r,gid:J,initials:n})}).finally(()=>d(!1));if(504===s.status){alert("sorry, request took too long! try again in a few seconds"),(0,g.JL)(u.f_);return}let{error:a}=await s.json().finally(()=>d(!1));if(a){alert("sorry! try again in a few seconds");return}(0,g.JL)(u.a_),q.push("/leaderboard")},K=()=>{V||(localStorage.setItem("gid",J),localStorage.setItem("score",t.toString()),localStorage.setItem("loss_text",(0,u._G)({guess:S[S.length-1],prev:S[S.length-2]})),q.push("/login"))},Y=async e=>{let{score:t,text:r,initials:s}=e;if(!n){if(!V){K();return}await $({score:t,text:r,initials:s})}},M="GUESS"===G?1===S.length?"top-[20%]":"top-[35%] sm:top-1/4":"top-[7%]";return(0,s.jsxs)(s.Fragment,{children:[!H&&(0,s.jsx)("div",{className:"absolute ml-2 mt-2 font-comic",children:z?(0,s.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[z.avatar_url&&(0,s.jsx)("div",{className:"relative w-[24px] h-[24px] sm:w-[30px] sm:h-[30px]",children:(0,s.jsx)(y.default,{draggable:!1,src:z.avatar_url,fill:!0,alt:"Rock"})}),(0,s.jsx)(o.default,{href:"/user/".concat(z.handle),children:(0,s.jsxs)("p",{className:"text-gray-400",children:["@",z.handle]})}),(0,s.jsx)("p",{children:"|"}),(0,s.jsx)("button",{className:"underline",onClick:()=>{B()},children:"log out"})]}):(0,s.jsx)("div",{children:(0,s.jsx)(o.default,{href:"/login",children:(0,s.jsx)("button",{className:"underline",children:"sign in"})})})}),(0,s.jsx)("div",{className:"font-comic h-dvh mx-4 sm:mx-32 md:mx-48 lg:mx-72 xl:mx-96",children:(0,s.jsxs)("div",{className:"flex flex-col pb-48 w-full items-center ".concat(M," justify-start relative"),children:["GUESS"===G&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-3xl",children:"what beats"}),(0,s.jsxs)("p",{className:"text-2xl text-center",children:[S[S.length-1].text,"?"]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"".concat(n?"animate-swell":""),children:"\uD83E\uDEA8"===S[S.length-1].emoji?(0,s.jsx)("div",{className:"w-[140px] h-[140px] sm:w-[250px] sm:h-[250px]",children:(0,s.jsx)(y.default,{priority:!0,draggable:!1,src:null!==(e=null==z?void 0:z.avatar_url)&&void 0!==e?e:"/profile/rock-default.png",fill:!0,alt:"Rock"})}):(0,s.jsx)("p",{className:"text-[120px] sm:text-[200px]",children:S[S.length-1].emoji})}),n&&(0,s.jsx)("p",{className:"absolute transition-transform top-[40%] left-[80%] transform -translate-x-1/2 -translate-y-1/2",style:n?{transform:"rotate(".concat(12,"deg) scale(",1.3,")")}:{},children:x}),n&&(0,s.jsx)("p",{className:"absolute transition-transform top-[20%] left-[20%] transform -translate-x-1/2 -translate-y-1/2",style:n?{transform:"rotate(".concat(36,"deg) scale(",3,")")}:{},children:x}),n&&(0,s.jsx)("p",{className:"absolute transition-transform top-[60%] left-[20%] transform -translate-x-1/2 -translate-y-1/2",style:n?{transform:"rotate(".concat(-45,"deg) scale(",5,")")}:{},children:x})]}),("scissors"===S[S.length-1].text.toLowerCase()||"scissor"===S[S.length-1].text.toLowerCase())&&(0,s.jsx)("div",{className:"flex flex-row pb-2",children:(0,s.jsx)("div",{className:"text-gray-400",children:(0,s.jsx)("p",{children:'try "fire," "diamond," or "hammer"'})})}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(null==x?void 0:x.trim())&&X()},children:[(0,s.jsx)("input",{autoFocus:"paper"!==x,className:"pl-4 py-4 text-lg border border-1-black",defaultValue:null!=x?x:void 0,disabled:n,placeholder:"paper"===S[S.length-1].text?"scissors":"scissors"===S[S.length-1].text.toLowerCase()||"scissor"===S[S.length-1].text.toLowerCase()?"anything, get creative":"",onChange:e=>{h(e.target.value)}}),(0,s.jsx)("button",{type:"submit",className:"p-4 border border-1-black text-lg ".concat(!n&&(null==x?void 0:x.trim())?"bg-green-200":"text-gray-400"),disabled:n||!(null==x?void 0:x.trim()),children:"GO"})]}),(0,s.jsxs)("p",{className:"text-gray-500 py-2",children:["score: ",t," ",1===S.length&&"rock"===S[S.length-1].text.toLowerCase()&&(0,s.jsx)(o.default,{href:"/leaderboard",className:"underline",children:"(see leaderboard)"})]}),1===S.length&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(p.P,{})})}),1===S.length&&(0,s.jsx)(E,{customGames:A}),S.length>1&&(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-center",children:"Already guessed:"})}),(0,s.jsx)("p",{className:"text-center",children:S.reduce((e,t,r)=>0===r?t.text:"".concat(t.text," \uD83E\uDD1C ").concat(e),"")})]})]}),"CORRECT"===G&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-2xl sm:text-4xl pb-2 text-center",children:S[S.length-1].text}),(0,s.jsx)("p",{className:"text-2xl sm:text-4xl pb-2 text-green-400 text-center",children:"beats"}),(0,s.jsx)("p",{className:"text-2xl sm:text-4xl pb-8 text-center",children:S[S.length-2].text}),(0,s.jsx)("p",{className:"text-lg text-center pb-4 text-pretty",children:F}),k?(0,s.jsx)("div",{className:"flex flex-row items-center justify-center bg-green-200 rounded-md p-1",children:(0,s.jsxs)("p",{className:"text-center px-2",children:["\uD83C\uDFC6 you are the 1st person to beat"," ",(0,s.jsxs)("span",{className:"font-black underline",children:[S[S.length-2].text," ",S[S.length-2].emoji]})," ","with"," ",(0,s.jsxs)("span",{className:"font-black underline",children:[S[S.length-1].text," ",S[S.length-1].emoji]})]})}):(0,s.jsx)("div",{className:"flex flex-row items-center justify-center bg-green-200 rounded-md p-1",children:(0,s.jsxs)("p",{className:"text-center px-2",children:["\uD83E\uDDE0 great minds think alike: ",O," others guessed this too!"]})}),(0,s.jsx)("p",{className:"text-gray-300 mt-2",children:"whatbeatsrock.com"}),(0,s.jsxs)("div",{className:"flex flex-row justify-center items-center",children:[(null==z?void 0:z.avatar_url)&&"\uD83E\uDEA8"===S[S.length-1].emoji?(0,s.jsx)("div",{className:"relative w-[160px] h-[160px]",children:(0,s.jsx)(y.default,{draggable:!1,src:z.avatar_url,fill:!0,objectFit:"contain",alt:"Rock"})}):(0,s.jsx)("p",{className:"text-[140px]",children:S[S.length-1].emoji}),(0,s.jsx)("p",{className:"text-4xl px-6",children:"\uD83E\uDD1C"}),(null==z?void 0:z.avatar_url)&&"\uD83E\uDEA8"===S[S.length-2].emoji?(0,s.jsx)("div",{className:"relative w-[160px] h-[160px]",children:(0,s.jsx)(y.default,{draggable:!1,src:z.avatar_url,fill:!0,objectFit:"contain",alt:"Rock"})}):(0,s.jsx)("p",{className:"text-[140px]",children:S[S.length-2].emoji})]}),(0,s.jsx)("button",{className:"py-4 px-8 border border-1-black text-lg",onClick:()=>{L(""),h(null),U("GUESS")},autoFocus:!0,children:"next"}),(0,s.jsxs)("p",{className:"text-gray-500 py-2",children:["score: ",t]}),S.length>1&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-center",children:"Already guessed:"})}),(0,s.jsx)("p",{className:"text-center",children:S.reduce((e,t,r)=>0===r?t.text:"".concat(t.text," \uD83E\uDD1C ").concat(e),"")})]})]}),"LOSS"===G&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("p",{className:"text-center text-3xl sm:text-5xl pb-2",children:S[S.length-1].text}),(0,s.jsx)("p",{className:"text-center text-3xl sm:text-5xl pb-2 text-red-400",children:"does not beat"}),(0,s.jsx)("p",{className:"text-center text-3xl sm:text-5xl pb-4",children:S[S.length-2].text}),O>0&&(0,s.jsx)("div",{className:"mb-4 flex flex-row items-center justify-center bg-red-200 rounded-md p-1",children:(0,s.jsxs)("p",{className:"text-center px-2",children:["\uD83E\uDD26‍♀️ ",O," other"," ",1===O?"person":"people"," already tried this"]})}),(0,s.jsx)("p",{className:"text-lg text-center pb-4 text-pretty",children:F}),(0,s.jsx)("p",{className:"text-gray-300 text-center",children:"whatbeatsrock.com"})]}),(0,s.jsxs)("div",{className:"flex flex-row justify-center items-center",children:[(0,s.jsx)("p",{className:"text-[140px]",children:S[S.length-1].emoji}),(0,s.jsx)("p",{className:"text-4xl px-6",children:"\uD83D\uDE35"}),(0,s.jsx)("p",{className:"text-[140px]",children:S[S.length-2].emoji})]}),(0,s.jsx)("div",{className:"flex flex-row my-2 gap-x-4",children:(0,s.jsxs)("p",{className:"text-gray-500",children:["score: ",t]})}),(0,s.jsx)("div",{className:"flex flex-row items-center justify-center gap-x-2",children:(0,s.jsxs)("p",{children:[S.reduce((e,t,r)=>0===r?t.text:r===S.length-1?"".concat(t.text," \uD83D\uDE35 ").concat(e):"".concat(t.text," \uD83E\uDD1C ").concat(e),"")," "]})}),(0,s.jsx)("button",{className:"mt-2  border bg-green-300 p-2 text-sm",onClick:()=>{(0,g.JL)(u.ki);let e=S.reduce((e,t,r)=>0===r?t.text:r===S.length-1?"".concat(t.text," \uD83D\uDE35 ").concat(e):"".concat(t.text," \uD83E\uDD1C ").concat(e),""),r="my whatbeatsrock.com score: "+t+"\n"+e;(0,v.p)({url:window.location.href,title:"WhatBeatsRock.com Score",text:r,textToCopy:r,alertText:"Copied!\n".concat(e,"\n Share with friends")})},children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-x-1",children:[(0,s.jsx)("p",{children:"Share"}),(0,s.jsx)(c.eA8,{})]})}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 pt-4 pb-2",children:[(0,s.jsx)("button",{onClick:()=>location.reload(),className:"p-2 px-4 border border-1-black text-lg",disabled:n,children:"play again"}),(0,s.jsx)("button",{autoFocus:!0,onClick:()=>Y({score:t,text:(0,u._G)({guess:S[S.length-1],prev:S[S.length-2]})}),className:"p-2 px-4 border border-1-black text-lg",disabled:n,children:V?"save score":"sign in to save score"})]})]}),!("GUESS"===G&&1===S.length)&&(0,s.jsx)("div",{className:"fixed bottom-0 bg-white p-2 w-full text-center",children:(0,s.jsx)(p.P,{})}),1===S.length&&(0,s.jsxs)("div",{className:"font-comic",children:["Trophies have moved:"," ",z?(0,s.jsx)(o.default,{href:"/user/".concat(z.handle),className:"underline",children:"see them in your profile"}):(0,s.jsx)(o.default,{href:"/login",className:"underline",children:"sign in to access them"})]}),1===S.length&&(0,s.jsx)("div",{className:"font-comic",children:(0,s.jsx)(o.default,{href:"/docs/privacy",className:"underline text-sm text-gray-400",children:"Privacy"})})]})})]})}},1149:function(e,t,r){"use strict";r.d(t,{B7:function(){return d},BI:function(){return x},Dc:function(){return a},Gb:function(){return u},Pn:function(){return l},UG:function(){return s},t6:function(){return i},wS:function(){return o},yK:function(){return c}});var n=r(2686);let s=async e=>{let{data:t,error:r}=await fetch("/api/users?handle=".concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());return r?(console.error("Error getting user by handle ",{error:r}),null):t},a=async e=>{let{data:t,error:r}=await fetch("/api/trophies/".concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());return r?(console.error("Error getting user trophies ",{error:r}),null):t},o=async e=>{let{data:t,error:r}=await fetch("/api/scores/".concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());return r?(console.error("Error getting user scores ",{error:r}),null):t},l=async function(){let{sortBy:e="PLAYS"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{data:t,error:r}=await fetch("/api/custom?sort=".concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());return r?(console.error("Error getting custom games ",{error:r}),null):t},c=async e=>{let{gameTitle:t,startWord:r,startEmoji:n,character:s,judgingCriteria:a,judgingCriteriaLoss:o,adjectiveCommentary:l,adjectiveExplanation:c,punishReward:i,additionalRules:u,guess1:d,prev1:x,wins1:h,reason1:m,guess2:f,prev2:p,wins2:g,reason2:j,guess3:y,prev3:b,wins3:v,reason3:N}=e,{error:w}=await fetch("/api/me/custom",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gameTitle:t,startWord:r,startEmoji:n,character:s,judgingCriteria:a,judgingCriteriaLoss:o,adjectiveCommentary:l,adjectiveExplanation:c,punishReward:i,additionalRules:u,guess1:d,prev1:x,wins1:h,reason1:m,guess2:f,prev2:p,wins2:g,reason2:j,guess3:y,prev3:b,wins3:v,reason3:N})}).then(e=>e.json());return w?(console.error("Error submitting custom game prompt ",{error:w}),{error:w}):{data:!0}},i=async e=>{let{data:t,error:r}=await fetch("/api/users/".concat(e,"/custom"),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).catch(e=>{if("NEXT_NOT_FOUND"===e.message)return{data:null}});return r?(r!==n.F&&console.error("Error getting user custom game data ",{error:r}),null):t},u=async()=>{let{data:e,error:t}=await fetch("/api/me/custom",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());return t?(t!==n.F&&console.error("Error getting my custom game data ",{error:t}),null):e},d=async e=>{let{error:t}=await fetch("/api/me/custom/like",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({fid:e,is_upvote:!0})}).then(e=>e.json());return!t||(console.error("Error upvoting custom game ",{error:t}),!1)},x=async e=>{let{error:t}=await fetch("/api/me/custom/like",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({fid:e})}).then(e=>e.json());return!t||(console.error("Error unvoting custom game ",{error:t}),!1)}},7054:function(e,t,r){"use strict";r.d(t,{JE:function(){return a},Ol:function(){return s}});var n=r(2265);function s(e){(0,n.useEffect)(e,[])}let a=(e,t)=>{let r=(0,n.useRef)(!1),s=(0,n.useRef)(e);(0,n.useEffect)(()=>{s.current=e},[e]),(0,n.useEffect)(()=>{t&&!r.current&&(r.current=!0,s.current())},[t])}},8500:function(e,t,r){"use strict";r.d(t,{$A:function(){return o},JL:function(){return i},zb:function(){return l}});var n=r(4681),s=r.n(n);let a=!1,o=e=>{try{if(c(),!a){console.error("mp not initialized");return}s().identify(e)}catch(e){console.error("mp error",e)}},l=()=>{try{if(c(),!a){console.error("mp not initialized");return}s().reset()}catch(e){console.error("mp error",e)}},c=()=>{a||(s().init("db23a9c3b81c14a0cd0f778e7549ac1a",{track_pageview:!0,persistence:"localStorage"}),a=!0)},i=(e,t)=>{try{if(c(),!a){console.error("mp not initialized");return}s().track(e,t)}catch(e){console.error("mp error",e)}}},668:function(e,t,r){"use strict";r.d(t,{p:function(){return n}});let n=e=>{let{title:t,url:r,text:n,textToCopy:s,alertText:a}=e,o=navigator;o.canShare&&o.canShare({url:r,title:t,text:n})?navigator.share({url:r,title:t,text:n}):(navigator.clipboard.writeText(s),alert(null!=a?a:"Copied ".concat(s)))}},3847:function(e,t,r){"use strict";function n(){let e=!1;try{e="1"===localStorage.getItem("ts")}catch(e){}return e}function s(){try{localStorage.setItem("ts","1")}catch(e){}}r.d(t,{_:function(){return s},x:function(){return n}})},2776:function(e,t,r){"use strict";r.d(t,{P:function(){return o}});var n=r(7437),s=r(7138),a=r(6648);function o(){return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,n.jsxs)("div",{children:["follow the creators"," ",(0,n.jsx)(s.default,{className:"underline",href:"https://x.com/dragon_khoi",target:"_blank",children:"khoi\uD83D\uDC1F"})," & ",(0,n.jsx)(s.default,{className:"underline",href:"https://x.com/qualiaspace",target:"_blank",children:"kyle\uD83E\uDD6C"})]}),(0,n.jsxs)("div",{children:["join the community on"," ",(0,n.jsx)(s.default,{className:"underline",href:"https://discord.gg/bjbHyFEyWv",target:"_blank",children:"discord \uD83D\uDCAC"})]}),(0,n.jsxs)("div",{className:"text-gray-600 text-sm flex flex-row items-center gap-x-2",children:[(0,n.jsx)("p",{children:"powered by "}),(0,n.jsx)(s.default,{className:"underline",href:"https://deepinfra.com?utm_source=whatbeatsrock",target:"_blank",children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[(0,n.jsx)("span",{children:"deepinfra"}),(0,n.jsx)(a.default,{src:"/deepinfra.png",alt:"Logo for deepinfra",width:12,height:12})]})})]})]})}},2686:function(e,t,r){"use strict";r.d(t,{$p:function(){return c},F:function(){return a},X4:function(){return i},XQ:function(){return n},bg:function(){return o},gs:function(){return u},qm:function(){return d},tl:function(){return l},vn:function(){return s}});let n=2,s=["rock-default","rock-cap","rock-crown","rock-flower","rock-lips","rock-pig","rock-sprout"],a="GAME_NOT_FOUND",o=36,l=11,c=30,i=16,u=140,d=70},4896:function(e,t,r){"use strict";r.d(t,{m:function(){return x},u:function(){return h}});var n=r(7437),s=r(4392),a=r(2265),o=r(6463),l=r(7054),c=r(9354),i=r(3847),u=r(8500);let d=(0,a.createContext)(null);function x(){let e=(0,a.useContext)(d);if(null===e)throw Error("useAccount must be used within an AccountProvider");return(0,a.useEffect)(()=>{if(!e.user)return},[e.user]),{...e}}let h=e=>{let{children:t}=e,[r,x]=(0,a.useState)(!0),[h,m]=(0,a.useState)(null),[f,p]=(0,a.useState)(null),g=(0,s.createClientComponentClient)(),j=(0,o.useRouter)(),[y,b]=(0,a.useState)([]);(0,l.Ol)(()=>{S().finally(()=>x(!1))});let v=async e=>{let{userId:t,handle:r,avatar_url:n,nux_step:s}=e,a="oops we ran into an error, try again in a bit";if(!t)return a;let{data:o,error:l}=await fetch("/api/users/".concat(t,"/profile"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({handle:r,avatar_url:n,nux_step:s})}).then(e=>e.json());return l||!o?(console.error("error updating profile:",l),(null==l?void 0:l.message)===c.EK)?"invalid or taken handle":a:(p(o),null)},N=async e=>{if((0,i.x)())return;let{error:t}=await fetch("/api/trophies/save-local",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trophies:e})}).then(e=>e.json());if(t){console.error("Error saving local trophies:",t);return}(0,i._)()},w=async()=>{let{data:e,error:t}=await fetch("/api/trophies",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());return(t||!e)&&console.error("Error fetching trophies:",t),e},E=async e=>{let{data:t,error:r}=await fetch("/api/users/".concat(e,"/profile"),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json());if(r||!t){console.error("error fetching profile:",r);return}p(t)},D=async()=>{let e=window.location.origin;await g.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(e,"/api/auth/callback"),queryParams:{access_type:"offline",prompt:"consent"}}}).then(e=>{e.error&&console.log("Error signing in with Google:",e.error)}).catch(e=>console.error("Error signing in with Google:",e))},_=async()=>{let e=window.location.origin;await g.auth.signInWithOAuth({provider:"discord",options:{redirectTo:"".concat(e,"/api/auth/callback")}}).then(e=>{e.error&&console.log("Error signing in with Discord:",e.error)}).catch(e=>console.error("Error signing in with Discord:",e))},S=async()=>{let e=await g.auth.getUser().then(async e=>(m(e.data.user),e.data.user&&(0,u.$A)(e.data.user.id),e.data.user)).catch(e=>(console.error(e),m(null),p(null),(0,u.zb)(),null));e&&await E(e.id)},C=async()=>{await g.auth.signOut(),m(null),p(null),(0,u.zb)(),y.forEach(e=>{try{e.callback()}catch(t){console.error("Error calling log out handler ".concat(e.name),t)}}),j.refresh()};return(0,n.jsx)(d.Provider,{value:{user:h,profile:f,isLoadingInitial:r,signInWithGoogle:D,signInWithDiscord:_,signOut:C,addLogOutHandler:e=>{if(y.find(t=>t.name===e.name))throw Error("Log out handler ".concat(e.name," already exists"));b(t=>[...t,e])},updateProfile:v,saveLocalTrophies:N,fetchTrophies:w},children:t})}},9354:function(e,t,r){"use strict";r.d(t,{$q:function(){return o},$x:function(){return h},BP:function(){return s},EK:function(){return i},Em:function(){return b},G2:function(){return p},KI:function(){return d},SH:function(){return c},Vg:function(){return g},XJ:function(){return x},Ym:function(){return n},_G:function(){return y},a_:function(){return m},f_:function(){return f},gv:function(){return j},ki:function(){return u},nV:function(){return a},qw:function(){return l},uf:function(){return v}});let n="___",s="OAI_SORRY_ERROR",a="TRY_AGAIN_ERROR",o="RATE_LIMIT_EXCEEDED",l="L_FILTER_ERROR",c="WEIRD_ERROR",i="INVALID_HANDLE_ERROR",u="share_button",d="submit_guess",x="submit_custom_guess",h="edit_custom_game",m="submit_score",f="api_timeout",p="America/Los_Angeles",g=/(?:\uD83C[\uDDE6-\uDDFF])|(?:\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF])|(?:\uD83E[\uDD00-\uDDFF])|[\u2600-\u27BF]|[\uD83C-\uDBFF\uDC00-\uDFFF]/g;function j(){let e=new Date(new Date().toLocaleString("en-US",{timeZone:p})),t=(8-e.getDay())%7;return e.setDate(e.getDate()+(0===t?7:t)),e.setHours(0,0,0,0),e}function y(e){let{guess:t,prev:r}=e;return"".concat(t.text.trim()," ").concat(t.emoji," did not beat ").concat(r.text.trim()," ").concat(r.emoji)}function b(e){return"whatbeatsrock.com/user/".concat(e)}function v(e){if(e<1e3)return e.toString();let t=["k","M","B","T"],r=-1,n=e;for(;n>=1e3&&r<t.length-1;)n/=1e3,r++;return n.toFixed(1)+t[r]}}},function(e){e.O(0,[603,310,231,477,648,971,526,744],function(){return e(e.s=4900)}),_N_E=e.O()}]);